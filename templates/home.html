<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Nurse Success Study Hub - Interactive Quiz Application">
  <title>Nurse Success Study Hub</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/home-style.css">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Vercel Analytics -->
  <script defer src="https://cdn.vercel-analytics.com/v1/web.js"></script>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="hub-header">
      <h1>Nurse Success Study Hub</h1>
      <p class="tagline">Master your nursing knowledge with targeted study modules</p>
    </header>

    <!-- Search Bar -->
    <div class="search-container">
      <input 
        type="text" 
        id="searchInput" 
        class="search-bar" 
        placeholder="Search study categories..."
      >
    </div>

    <!-- Categories Grid -->
    <main class="categories-grid" id="categoriesContainer">
      <!-- Categories will be loaded here by JavaScript -->
    </main>

    <!-- Footer -->
    <footer class="hub-footer">
      <p>&copy; 2025 Nurse Success Study Hub. Study smarter, succeed faster.</p>
    </footer>
  </div>

  <script>
    const categoryColors = {
      'Patient Care Management': '#FF6B6B',
      'HESI': '#4ECDC4',
      'Nursing Certifications': '#45B7D1',
      'Pharmacology': '#96CEB4'
    };

    const categoryIcons = {
      'Patient Care Management': 'ðŸ‘¥',
      'HESI': 'ðŸ“‹',
      'Nursing Certifications': 'ðŸ†',
      'Pharmacology': 'ðŸ’Š'
    };

    const categoryImages = {
      'Patient Care Management': 'https://raw.githubusercontent.com/Shensley102/Final-Semester-Study-Guide/refs/heads/main/images/Nursing_Leadership_Image.png',
      'HESI': 'https://raw.githubusercontent.com/Shensley102/Final-Semester-Study-Guide/refs/heads/main/images/Nursing_Hesi_Exam_Prep_Image.png',
      'Nursing Certifications': 'https://raw.githubusercontent.com/Shensley102/Final-Semester-Study-Guide/refs/heads/main/images/Nursing_Advanced_Certifications.png',
      'Pharmacology': 'https://raw.githubusercontent.com/Shensley102/Final-Semester-Study-Guide/refs/heads/main/images/Nursing_Pharmacology_Image.png'
    };

    // Categories that skip the middle category page and go straight to quiz
    const skipCategoryPage = ['Patient Care Management', 'HESI'];

    async function loadCategories() {
      try {
        const res = await fetch('/api/categories');
        if (!res.ok) throw new Error('Failed to load categories');
        
        const categories = await res.json();
        const container = document.getElementById('categoriesContainer');
        
        // Define the order for 4x1 grid: left to right
        const orderedCategories = [
          'Patient Care Management',
          'HESI',
          'Pharmacology',
          'Nursing Certifications'
        ];
        
        container.innerHTML = orderedCategories.map((key) => {
          const data = categories[key];
          if (!data) return '';
          
          const icon = categoryIcons[key] || 'ðŸ“š';
          const color = categoryColors[key] || '#2f61f3';
          const imageUrl = categoryImages[key];
          
          // Determine the link based on whether we skip the category page
          let href;
          if (skipCategoryPage.includes(key)) {
            href = `/quiz?category=${encodeURIComponent(key)}`;
          } else {
            href = `/category/${encodeURIComponent(key)}`;
          }
          
          // All cards now use image format
          return `
            <a href="${href}" class="category-card image-card" style="--accent-color: ${color}">
              <img src="${imageUrl}" 
                   alt="${key}"
                   onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
              <div class="fallback-icon" style="display:none; font-size: 60px;">${icon}</div>
              <div class="card-arrow">â†’</div>
            </a>
          `;
        }).join('');
      } catch (error) {
        console.error('Error loading categories:', error);
        document.getElementById('categoriesContainer').innerHTML = `
          <div style="grid-column: 1/-1; padding: 40px; text-align: center; color: var(--danger);">
            <p>Error loading categories. Please refresh the page.</p>
          </div>
        `;
      }
    }

    // Search functionality
    document.getElementById('searchInput').addEventListener('input', (e) => {
      const searchTerm = e.target.value.toLowerCase();
      const cards = document.querySelectorAll('.category-card');
      
      cards.forEach(card => {
        const alt = card.querySelector('img')?.alt.toLowerCase() || '';
        const matchesSearch = alt.includes(searchTerm);
        card.style.display = matchesSearch ? '' : 'none';
      });
    });

    // Load categories on page load
    loadCategories();
  </script>
</body>
</html>
