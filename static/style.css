/* ===== Global ===== */
html { scroll-behavior: auto; }
@media (prefers-reduced-motion: reduce) { html { scroll-behavior: auto; } }

:root{
  --bg:#f7f8fc;
  --card:#fff;
  --ink:#0b1320;
  --ink-soft:#4a5568;
  --primary:#2f61f3;      /* blue for Next state */
  --danger:#d33a2c;       /* red for errors / Reset outline */
  --success:#22c55e;      /* green for success / progress bar */
  --ring:#cdd9ff;
  --border:#e7eaf3;

  --radius:16px;
  --shadow-sm:0 1px 2px rgba(16,24,40,.06);
  --shadow-md:0 4px 10px rgba(16,24,40,.08);

  /* Progress bar segment settings */
  --tick: 16px;
  --tick-line: 2px;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
}

.container{
  max-width: 980px;
  margin: 28px auto 56px;
  padding: 0 16px;
}

/* ===== Title bar with button ===== */
.title-bar{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  margin-bottom: 18px;
  flex-wrap: wrap;
}

/* ===== Headline ===== */
h1{
  margin: 0;
  font-weight: 800;
  letter-spacing: .3px;
  font-size: clamp(28px, 4.5vw, 44px);
}

h2{
  margin: 0;
  font-weight: 700;
  font-size: clamp(20px, 3vw, 28px);
}

h3{
  margin: 0 0 12px 0;
  font-weight: 700;
  font-size: 18px;
}

/* ===== Cards ===== */
.card{
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-sm);
  padding: 20px;
  margin: 18px 0;
}

/* ===== Counters ===== */
.counters{
  display:flex;
  flex-direction: column;
  align-items:flex-start;
  gap: 8px;
  margin: 10px 0 14px;
}
.count-row{
  display:flex;
  align-items:center;
  gap: 16px;
  width: 100%;
}
#resetAll{ margin-left:auto; }

/* ===== Progress bar (full width; hash marks on track & fill) ===== */
.pbar-wrap{ display:flex; align-items:center; gap:12px; width:100%; }
.pbar{
  position:relative;
  width: 100%;
  height: 20px;
  border-radius:999px;
  overflow:hidden;
  border:1px solid var(--border);
  box-shadow: var(--shadow-sm);
  background:#e9edf8; /* base track color */
}
/* Track hash marks (visible at 0%) */
.pbar::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  background-image: repeating-linear-gradient(
    to right,
    rgba(0,0,0,.10) 0 var(--tick-line),
    transparent var(--tick-line) var(--tick)
  );
}
.pbar-fill{
  position: relative;
  height:100%;
  width:0%;
  background: var(--success);
  transition: width .25s ease;
  border-radius: inherit;
}
/* Fill hash marks (overlay on green) */
.pbar-fill::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  background-image: repeating-linear-gradient(
    to right,
    rgba(255,255,255,.35) 0 var(--tick-line),
    rgba(255,255,255,0) var(--tick-line) var(--tick)
  );
}
.pbar-label{ font-size: 1rem; color:var(--ink-soft); }

/* ===== Form controls ===== */
.field{ margin: 14px 0 18px; }
label{ display:block; font-weight:600; margin-bottom:8px; color:var(--ink-soft); }

/* Segmented length buttons */
.seg{ display:flex; gap:12px; flex-wrap:wrap; }
.seg-btn{
  border:1px solid var(--border);
  background:#fff;
  padding:10px 16px;
  border-radius: 9999px;
  cursor:pointer;
  box-shadow: var(--shadow-sm);
  transition: transform .02s ease, box-shadow .15s ease, border-color .15s ease;
}
.seg-btn:hover{ box-shadow: var(--shadow-md); }
.seg-btn.active{
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(47,97,243,.18);
}

/* Buttons */
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  border: 1px solid transparent;
  border-radius: 12px;
  padding: 12px 18px;
  font-weight: 600;
  cursor: pointer;
  transition: transform .02s ease, box-shadow .15s ease, background-color .15s ease;
  box-shadow: var(--shadow-sm);
  min-width: 120px;
}
.btn:hover{ box-shadow: var(--shadow-md); }
.btn.primary{ background: var(--success); color:#fff; }
.btn.btn-blue{ background: var(--primary); color:#fff; }
.btn.danger{ background:#fff; color: var(--danger); border-color: var(--danger); }

/* Full-width submit button */
#submitBtn{
  width: 100%;
  min-width: unset;
}

/* Actions rows */
.actions{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; }

/* ===== Question / Options ===== */
/* Open Sans, slightly smaller, normal weight */
.question{
  font-family: 'Open Sans', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  font-size: clamp(18px, 2.4vw, 26px);
  font-weight: 400;
  margin: 10px 0 18px;
}

.options{ display:grid; gap:12px; margin:0 0 12px; }
.opt{
  display:flex; 
  align-items:center; 
  gap:14px;
  border:2px solid var(--border);
  background:#fff;
  border-radius: 12px;
  padding: 12px 14px;
  box-shadow: var(--shadow-sm);
  transition: border-color .15s ease, background-color .15s ease, box-shadow .15s ease;
  cursor: pointer;
}

/* Hover only when no option is selected or in multi-select mode */
.options:not(.has-selection) .opt:hover,
.options.is-multi-select .opt:hover {
  border-color: var(--success);
  background-color: #f9fdf6;
}

/* Highlight entire box when input is checked */
.opt:has(input:checked){
  border-color: var(--success);
  background-color: #f0fde8;
  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2);
}

/* Modern custom checkbox and radio styling */
.opt input[type="radio"],
.opt input[type="checkbox"]{
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  width: 24px;
  height: 24px;
  border: 2px solid #d0d9e8;
  border-radius: 8px;
  cursor: pointer;
  background-color: #fff;
  transition: all .2s ease;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  accent-color: var(--primary);
}

/* Hover state for checkbox/radio */
.options:not(.has-selection) .opt input[type="radio"]:hover,
.options:not(.has-selection) .opt input[type="checkbox"]:hover,
.options.is-multi-select .opt input[type="radio"]:hover,
.options.is-multi-select .opt input[type="checkbox"]:hover {
  border-color: var(--success);
  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
}

/* Checked state for checkbox/radio */
.opt input[type="radio"]:checked,
.opt input[type="checkbox"]:checked {
  background-color: var(--success);
  border-color: var(--success);
  box-shadow: inset 0 0 0 2px #fff;
}

/* Checked checkmark appearance */
.opt input[type="checkbox"]:checked::after {
  content: 'âœ“';
  color: #fff;
  font-size: 14px;
  font-weight: bold;
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Radio button checked state */
.opt input[type="radio"]:checked::after {
  content: '';
  position: absolute;
  width: 8px;
  height: 8px;
  background-color: #fff;
  border-radius: 50%;
}

/* Disabled state */
.opt input:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.opt label{ 
  cursor:pointer; 
  display:flex; 
  gap:10px; 
  align-items:center; 
  width:100%;
  margin: 0;
  font-weight: 500;
}
.opt .k{ 
  font-weight:700; 
  color:var(--ink-soft); 
  min-width:20px;
  font-size: 14px;
}
.opt .ans{ 
  color:var(--ink);
  line-height: 1.3;
}

/* ===== Feedback / Answer / Rationale ===== */
.feedback{ margin:12px 0 6px; font-weight:800; font-size:clamp(18px, 2.2vw, 24px); }
.feedback.ok{ color:var(--success); }
.feedback.bad{ color:var(--danger); }

.answer-line{ border-left:4px solid var(--primary); padding-left:12px; margin:6px 0 8px; }
.answer-line:empty{ border-left:0; padding-left:0; }

.rationale{
  border: 1px dashed var(--border);
  border-radius: 12px;
  padding: 12px 14px;
  background: #fafbff;
  color: var(--ink-soft);
}

/* ===== Summary ===== */
.first-try{ display:flex; gap:20px; align-items:center; margin-bottom:12px; flex-wrap:wrap; margin-top:16px; }
.review-list{ display:grid; gap:12px; margin-top:16px; }
.rev-item{
  border: 1px solid var(--border);
  border-radius: 12px;
  background:#fff;
  padding: 12px 14px;
  box-shadow: var(--shadow-sm);
}
.rev-item.ok{ border-left: 4px solid var(--success); }
.rev-item.bad{ border-left: 4px solid var(--danger); }
.rev-q{ font-weight:700; margin-bottom:6px; }
.rev-wrong-count{ 
  color:#fff;
  font-size: 1rem;
  margin: 8px 0;
  font-weight: 700;
  border: 2px solid #333;
  padding: 10px 14px;
  border-radius: 8px;
  display: inline-block;
  min-width: 200px;
  text-align: center;
  background-color: #22c55e;
}
.rev-wrong-count.yellow{
  background-color: #eab308;
  border-color: #ca8a04;
}
.rev-wrong-count.orange{
  background-color: #f97316;
  border-color: #ea580c;
}
.rev-wrong-count.red{
  background-color: #ef4444;
  border-color: #dc2626;
}
.rev-ans, .rev-rationale{ color:var(--ink-soft); }

/* ===== Utilities ===== */
.hidden{ display:none !important; }

/* ===== Help section ===== */
.help{ margin-top: 8px; color: var(--ink-soft); }
.help h3{ margin:6px 0 10px; color: var(--ink); }
.help ul{ margin:0; padding-inline-start: 18px; display:grid; gap:6px; }
.help li{ line-height:1.45; }
kbd, .kbd{
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:.9em; background:#fff; border:1px solid var(--border); border-radius:6px; padding:1px 6px;
}

/* Focus ring */
button:focus-visible, .select:focus-visible, input:focus-visible{
  outline:3px solid var(--ring); outline-offset:2px;
}

/* Module label inline with picker */
label[for="moduleSel"]{ display:inline-block; margin: 0 12px 0 0; vertical-align: middle; }

/* Module picker styling */
#moduleSel{
  appearance: none;
  font-size: calc(1em * 1.5);
  line-height: 1.2;
  padding: 0.5625rem 2.5rem 0.5625rem 0.75rem;
  min-height: 2.25rem;

  border-radius: 10px;
  border: 1px solid #c9d5ee;
  background: #fff;
  color: inherit;
  max-width: 100%;
  vertical-align: middle;

  box-shadow: 0 1px 2px rgba(16,24,40,.06);

  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%23121' d='M1.41.59 6 5.17 10.59.59 12 2 6 8 0 2z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 12px 8px;
}
#moduleSel:focus{
  outline: none; border-color: #7aa2ff; box-shadow: 0 0 0 3px rgba(47,97,243,.25);
}
#moduleSel::-ms-expand{ display:none; }
